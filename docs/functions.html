

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Functions &mdash; spectrapepper  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Quickstart" href="quickstart.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> spectrapepper
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">SpectraPepper</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributions.html">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">spectrapepper</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/functions.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-functions">
<span id="functions"></span><h1>Functions<a class="headerlink" href="#module-functions" title="Permalink to this headline">¶</a></h1>
<p>This main module contains all the functions available in spectrapepper. Please
use the search function to look up specific functionalities and keywords.</p>
<dl class="function">
<dt id="functions.alsbaseline">
<code class="descclassname">functions.</code><code class="descname">alsbaseline</code><span class="sig-paren">(</span><em>data</em>, <em>lam=100</em>, <em>p=0.001</em>, <em>niter=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#alsbaseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.alsbaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculation of the baseline using Asymmetric Least Squares Smoothing. This
script only makes the calculation but it does not remove it. Original idea of
this algorithm by P. Eilers and H. Boelens (2005):</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Spectra to calculate the baseline from.</li>
<li><strong>lam</strong> (<em>int</em>) – Lambda, smoothness. The default is 100.</li>
<li><strong>p</strong> (<em>float</em>) – Asymmetry. The default is 0.001.</li>
<li><strong>niter</strong> (<em>int</em>) – Niter. The default is 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Returns the calculated baseline.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.areacalculator">
<code class="descclassname">functions.</code><code class="descname">areacalculator</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>limits</em>, <em>norm=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#areacalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.areacalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Area calculator using the data (x_data) and the limits in position, not
values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to calculate area from.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X axis of the data.</li>
<li><strong>limits</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Limits that define the areas to be calculated. Axis value.</li>
<li><strong>norm</strong> (<em>bool</em>) – If True, normalized the area to the sum under all the curve.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of areas according to the requested limits.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.asymmetry">
<code class="descclassname">functions.</code><code class="descname">asymmetry</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>peak</em>, <em>s=5</em>, <em>limit=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#asymmetry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.asymmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Comparesboth sides of a peak, or list of peaks, and check how similar they
are. It does this by calculating the MRSE and indicating which side is 
larger or smaller. If it is a negative (-), then left side is smaller.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em>) – spectrocopic data to calculate the fwhm from. Single vector or
list of vectors.</li>
<li><strong>x</strong> (<em>list</em>) – Axis of the data. If none, then the axis will be 0..N where N is
the length of the spectra or spectras.</li>
<li><strong>peak</strong> (<em>float</em><em>, </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Aproximate axis value of the position of the peak. If sinlge
peak then a float is needed. If many peaks are requierd then a list of
them.</li>
<li><strong>s</strong> (<em>int</em>) – Shift to sides to check real peak. The default is 5.</li>
<li><strong>limit</strong> (<em>int</em>) – Comparison limits to each side of the peak. Default is 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">R2 value comparing both sides of the peak and a sign to tell if
either left side is smaller (negative) or tight side is smaller
(positive, no sign included).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.avg">
<code class="descclassname">functions.</code><code class="descname">avg</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#avg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.avg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the average vector from a list of vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of vectors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The average of the vectors in the list.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.bincombs">
<code class="descclassname">functions.</code><code class="descname">bincombs</code><span class="sig-paren">(</span><em>n</em>, <em>s_min=1</em>, <em>s_max=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#bincombs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.bincombs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all possible unique combinations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n</strong> (<em>int</em>) – Amount of positions.</li>
<li><strong>s_min</strong> (<em>int</em>) – Minimum amount of 1s.</li>
<li><strong>s_max</strong> (<em>int</em>) – Maximum amount of 1s.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of unique combinations.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[tuple]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.bspbaseline">
<code class="descclassname">functions.</code><code class="descname">bspbaseline</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>points</em>, <em>avg=5</em>, <em>remove=True</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#bspbaseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.bspbaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcuates the baseline using b-spline.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single or several spectras to remove the baseline from.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – x axis of the data, to interpolate the baseline function.</li>
<li><strong>points</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – axis values of points to calculate the bspine.</li>
<li><strong>avg</strong> (<em>int</em>) – points to each side to make average.</li>
<li><strong>remove</strong> (<em>True</em>) – if True, calculates and returns (data - baseline).</li>
<li><strong>plot</strong> (<em>bool</em>) – if True, calculates and returns (data - baseline).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The baseline.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.classify">
<code class="descclassname">functions.</code><code class="descname">classify</code><span class="sig-paren">(</span><em>data</em>, <em>gnumber=3</em>, <em>glimits=[]</em>, <em>var='x'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#classify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.classify" title="Permalink to this definition">¶</a></dt>
<dd><p>Classifies targets according to either defined limits or number of groups.
The latter depends on the defined parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Vector with target values to be classified.</li>
<li><strong>gnumber</strong> (<em>int</em>) – Number of groups to create. The default is 3 and is the default technique.</li>
<li><strong>glimits</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Defined group limits. The default is [].</li>
<li><strong>glimits</strong> – Name of the variable that is being classified.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Vector with the classification from 0 to N. A list with strings with the name of the groups, useful for plotting.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[list,list]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.cmscore">
<code class="descclassname">functions.</code><code class="descname">cmscore</code><span class="sig-paren">(</span><em>x_points</em>, <em>y_points</em>, <em>target</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#cmscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.cmscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the distance between points and the center of mass (CM) of
clusters and sets the prediction to the closest CM. This score may be
higher or lower than the algorithm score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_points</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Coordinates of x-axis.</li>
<li><strong>y_points</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Coordinates of y-axis.</li>
<li><strong>target</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Targets of each point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Score by comparing CM distances. Prediction using CM distances.
X-axis coords of ths CMs. Y-axis coords of the Cms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float, list[int],list[float],list[float]]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.colormap">
<code class="descclassname">functions.</code><code class="descname">colormap</code><span class="sig-paren">(</span><em>colors</em>, <em>name='my_name'</em>, <em>n=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#colormap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.colormap" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplify the creation of colormaps.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>colors</strong> (<em>list</em>) – List of colors thaat you ant on the colormap</li>
<li><strong>name</strong> (<em>string</em><em>, </em><em>optional</em>) – Name of the colormap. The default is ‘my_name’.</li>
<li><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Divisions. The default is 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Colormap in Matplotlib format.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">cmap</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.confusionmatrix">
<code class="descclassname">functions.</code><code class="descname">confusionmatrix</code><span class="sig-paren">(</span><em>tt, tp, gn=['', '', ''], plot=False, title='', cmm='Blues', fontsize=20, ylabel='True', xlabel='Prediction'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#confusionmatrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.confusionmatrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates and/or plots the confusion matrix for machine learning algorithm
results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tt</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Real targets.</li>
<li><strong>tp</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Predicted targets.</li>
<li><strong>plot</strong> (<em>boolean</em>) – If true, plots the matrix. The default is False</li>
<li><strong>gn</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Names, or lables , of the classification groups. Default is empty.</li>
<li><strong>title</strong> (<em>str</em>) – Name of the matrix. Default is empty.</li>
<li><strong>cmm</strong> (<em>str</em>) – Nam eof the colormap (matplotlib) to use for the plot. Default
is Blue.</li>
<li><strong>fontsize</strong> (<em>int</em>) – Font size for the labels. The default is 20.</li>
<li><strong>ylabel</strong> (<em>str</em>) – Label for y axis. Default is <cite>True</cite>.</li>
<li><strong>xlabel</strong> (<em>str</em>) – Label for x axis. Default is <cite>Prediction</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The confusion matrix</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.cosmicdd">
<code class="descclassname">functions.</code><code class="descname">cosmicdd</code><span class="sig-paren">(</span><em>y</em>, <em>th=100</em>, <em>asy=0.6745</em>, <em>m=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#cosmicdd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.cosmicdd" title="Permalink to this definition">¶</a></dt>
<dd><p>It identifies CRs by detrended differences, the differences between a
value and the next (D. A. Whitaker and K. Hayes, <a class="reference external" href="https://doi.org/10.1016/j.chemolab.2018.06.009">https://doi.org/10.1016/j.chemolab.2018.06.009</a>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of spectras to remove cosmic rays.</li>
<li><strong>th</strong> (<em>float</em>) – Factor to modify the criteria to identify a cosmic ray.</li>
<li><strong>asy</strong> (<em>float</em>) – Asymptotic bias correction</li>
<li><strong>m</strong> (<em>float</em>) – Number of neighbor values to use for average.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Data with removed cosmic rays.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.cosmicmed">
<code class="descclassname">functions.</code><code class="descname">cosmicmed</code><span class="sig-paren">(</span><em>y</em>, <em>sigma=1.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#cosmicmed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.cosmicmed" title="Permalink to this definition">¶</a></dt>
<dd><p>Precise cosmic ray elimination for measurements of the same point or very
similar spectras.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of spectras to remove cosmic rays.</li>
<li><strong>sigma</strong> (<em>float</em>) – Factor to modify the criteria to identify a cosmic ray.
Multiplies the median of each bin.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Data with removed cosmic rays.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.cosmicmp">
<code class="descclassname">functions.</code><code class="descname">cosmicmp</code><span class="sig-paren">(</span><em>y</em>, <em>alpha=1</em>, <em>avg=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#cosmicmp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.cosmicmp" title="Permalink to this definition">¶</a></dt>
<dd><p>It identifies CRs by comparing similar spectras and paring in matching
pairs. Uses randomnes of CRs (S. J. Barton, B. M. Hennelly, <a class="reference external" href="https://doi.org/10.1177/0003702819839098">https://doi.org/10.1177/0003702819839098</a>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of spectras to remove cosmic rays.</li>
<li><strong>alpha</strong> (<em>float</em>) – Factor to modify the criteria to identify a cosmic ray.</li>
<li><strong>avg</strong> (<em>int</em>) – Moving average window.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Data with removed cosmic rays.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.decbound">
<code class="descclassname">functions.</code><code class="descname">decbound</code><span class="sig-paren">(</span><em>x_points</em>, <em>y_points</em>, <em>groups</em>, <em>limits=None</em>, <em>divs=0.5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#decbound"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.decbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Decision Boundaries.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_points</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X coordinates of each point.</li>
<li><strong>y_points</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Y coordinates of each point.</li>
<li><strong>groups</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of targets for each point.</li>
<li><strong>limits</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Plot and calculation limits. The default is ‘None’.</li>
<li><strong>divs</strong> (<em>float</em>) – Resolution. The default is 0.01.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The decision boundaries.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.decdensity">
<code class="descclassname">functions.</code><code class="descname">decdensity</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>groups</em>, <em>limits=None</em>, <em>divs=0.5</em>, <em>th=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#decdensity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.decdensity" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the density decision map from a cluster mapping.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X coordinates of each point.</li>
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Y coordinates of each point.</li>
<li><strong>groups</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of targets for each point.</li>
<li><strong>limits</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Plot and calculation limits. The default is ‘None’.</li>
<li><strong>divs</strong> (<em>float</em>) – Resolution ti calculate density. The default is 0.5.</li>
<li><strong>th</strong> (<em>int</em>) – Threshold from where a area is defined as a certain group.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The density decision map.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.evalgrau">
<code class="descclassname">functions.</code><code class="descname">evalgrau</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#evalgrau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.evalgrau" title="Permalink to this definition">¶</a></dt>
<dd><p>This function evaluates the MSE in 3 dimensions (x,y,z) for a set of
data vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – A list of lists of variables to compare.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A list with each combination and the R2 score obtained.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.fwhm">
<code class="descclassname">functions.</code><code class="descname">fwhm</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>peaks</em>, <em>s=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#fwhm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.fwhm" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Full Width Half Maximum of specific peak or list of
peaks for a single or multiple spectras.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em>) – spectrocopic data to calculate the fwhm from. Single vector or
list of vectors.</li>
<li><strong>x</strong> (<em>list</em>) – Axis of the data. If none, then the axis will be 0..N where N
is the length of the spectra or spectras.</li>
<li><strong>peaks</strong> (<em>float</em><em> or </em><em>list</em><em>[</em><em>float</em><em>]</em>) – Aproximate axis value of the position of the peak. If single
peak then a float is needed. If many peaks are requierd then a list of
them.</li>
<li><strong>s</strong> (<em>int</em>) – Shift to sides to check real peak. The default is 10.</li>
<li><strong>interpolate</strong> (<em>boolean</em>) – If True, will interpolte according to <cite>step</cite> and <cite>s</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list, or single float value, of the fwhm.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float or list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.gaussfit">
<code class="descclassname">functions.</code><code class="descname">gaussfit</code><span class="sig-paren">(</span><em>y=[0], x=[0], pos=0, look=10, shift=5, sigma=4.4, manual=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#gaussfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.gaussfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits peak as an optimization problem or manual fit. A curve <cite>y</cite> is only 
mandatory if the optimixzation is needed (manual=False, default). If no
axis ‘ax’ is defined, then a default axis is generated for both options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to fit. Single vector.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – x axis.</li>
<li><strong>pos</strong> (<em>int</em>) – Peak index to fit to.</li>
<li><strong>look</strong> (<em>int</em>) – index positions to look to each side. The default is 20.</li>
<li><strong>shift</strong> (<em>int</em>) – Possible index shift of the peak. The default is 5.</li>
<li><strong>sigma</strong> (<em>float</em>) – Sigma value for Gaussian fit. The default is 4.4.</li>
<li><strong>manual</strong> (<em>boolean</em>) – If <cite>True</cite>, 1 curve will be generated using the declared 
parameter <cite>sigma</cite> and perform a manual fit. Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted curve.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.grau">
<code class="descclassname">functions.</code><code class="descname">grau</code><span class="sig-paren">(</span><em>data</em>, <em>labels=[]</em>, <em>cm='seismic'</em>, <em>fons=20</em>, <em>figs=(25</em>, <em>15)</em>, <em>tfs=25</em>, <em>ti='Grau (Beta)'</em>, <em>marker='s'</em>, <em>marks=100</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#grau"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.grau" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs Grau correlation matrix and plots it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to be correlated.</li>
<li><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Labels of the data to be ploted.</li>
<li><strong>cm</strong> (<em>str</em>) – Color map for the plot, from matplotlib. The default is “seismic”.</li>
<li><strong>fons</strong> (<em>int</em><em>, </em><em>optional</em>) – Plot font size. The default is 20.</li>
<li><strong>figs</strong> (<em>tuple</em>) – Figure size. The default is (25,15).</li>
<li><strong>tfs</strong> (<em>int</em>) – Plot title font size. The default is 25.</li>
<li><strong>ti</strong> (<em>str</em>) – Plot title. The default is “Grau (Beta)”.</li>
<li><strong>marker</strong> (<em>str</em>) – Plot marker type (scatter). The default is “s”.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True plots the matrix. The default is True.</li>
<li><strong>marks</strong> (<em>int</em>) – Marker size. The default is 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Grau plot in a 2d list.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.groupscores">
<code class="descclassname">functions.</code><code class="descname">groupscores</code><span class="sig-paren">(</span><em>all_targets</em>, <em>used_targets</em>, <em>predicted_targets</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#groupscores"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.groupscores" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the individual scores for a ML algorithm (i.e.: LDA, PCA, etc).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>all_targets</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – List of all real targets (making sure all groups are 
here).</li>
<li><strong>used_targets</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Targets to score on.</li>
<li><strong>predicted_targets</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Prediction of used_targets.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of scores for each group.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.interpolation">
<code class="descclassname">functions.</code><code class="descname">interpolation</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>step=1</em>, <em>start=0</em>, <em>finish=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#interpolation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.interpolation" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates data to a new axis. If there are multiple datasets with 
different axises in can interpolate to a common axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of data to interpolate</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em>) – list of the axises of the data</li>
<li><strong>step</strong> (<em>float</em>) – new step for the new axis</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Interpolated data and the new axis</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float], list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.isaxis">
<code class="descclassname">functions.</code><code class="descname">isaxis</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#isaxis"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.isaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects if there is an axis in the data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data containing spectras an possible axis.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if there is axis.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.issinglevalue">
<code class="descclassname">functions.</code><code class="descname">issinglevalue</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#issinglevalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.issinglevalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if a vector, or a list of vectors, is composed of the same value
(single value vector). Not to be confused with a single element vector 
were the length of the vector is 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>list</em>) – Vector, or list of vectors, that needs to be checked.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True if contains the same value. False if there are different. If
<cite>y</cite> is a list of vectors then it returns a list of booleans with the 
respective answer.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.load">
<code class="descclassname">functions.</code><code class="descname">load</code><span class="sig-paren">(</span><em>file</em>, <em>fromline=0</em>, <em>transpose=False</em>, <em>dtype=&lt;class 'float'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load data from a standard text file obtained from LabSpec and other
spectroscopy instruments. Normally, when single measurement these come in 
columns with the first one being the x-axis. When it is a mapping, the
first row is the x-axis and the following are the measurements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file</strong> (<em>str</em>) – Url of data file. Must not have headers and separated by ‘spaces’ (LabSpec).</li>
<li><strong>fromline</strong> (<em>int</em>) – Line of file from which to start loading data. The default is 0.</li>
<li><strong>transpose</strong> (<em>boolean</em>) – If True transposes the data. Default is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of the data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.loadline">
<code class="descclassname">functions.</code><code class="descname">loadline</code><span class="sig-paren">(</span><em>file</em>, <em>line=0</em>, <em>dtype='float'</em>, <em>split=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#loadline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.loadline" title="Permalink to this definition">¶</a></dt>
<dd><p>Random access to file. Loads a specific line in a file. Useful when
managing large data files in processes where time is important. It can
load numbers as floats.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file</strong> (<em>str</em>) – Url od the data file</li>
<li><strong>line</strong> (<em>int</em>) – Line number. Counts from 0.</li>
<li><strong>dtype</strong> (<em>str</em>) – Type of data. If its numeric then ‘float’, if text then ‘string’.
Default is ‘float’.</li>
<li><strong>split</strong> (<em>boolean</em>) – True to make a list of strings when ‘tp’ is ‘string’, 
separated by space. The default is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array with the desired line.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.lorentzfit">
<code class="descclassname">functions.</code><code class="descname">lorentzfit</code><span class="sig-paren">(</span><em>y=[0], x=[0], pos=0, look=10, shift=5, gamma=5, manual=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#lorentzfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.lorentzfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits peak as an optimization problem or manual fit for Lorentz distirbution,
also known as Cauchy. A curve <cite>y</cite> is only mandatory if the optimixzation 
is needed (manual=False, default). If no axis ‘x’ is defined, then a 
default axis is generated for both options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to fit. Single vector.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – x axis.</li>
<li><strong>pos</strong> (<em>int</em>) – X axis position of the peak.</li>
<li><strong>look</strong> (<em>int</em>) – index positions to look to each side. The default is 20.</li>
<li><strong>shift</strong> (<em>int</em>) – Possible index shift of the peak. The default is 5.</li>
<li><strong>gamma</strong> (<em>float</em>) – Initial value of fit. The default is 5.</li>
<li><strong>sigma</strong> (<em>boolean</em>) – If <cite>True</cite>, 1 curve will be generated using the declared 
parameter <cite>gamma</cite> and perform a manual fit. Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted curve.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.lowpass">
<code class="descclassname">functions.</code><code class="descname">lowpass</code><span class="sig-paren">(</span><em>data</em>, <em>cutoff=0.25</em>, <em>fs=30</em>, <em>order=2</em>, <em>nyq=0.75</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#lowpass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.lowpass" title="Permalink to this definition">¶</a></dt>
<dd><p>Butter low pass filter for a single or spectra or a list of them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of vectors in line format (each line is a vector).</li>
<li><strong>cutoff</strong> (<em>float</em>) – Desired cutoff frequency of the filter. The default is 0.25.</li>
<li><strong>fs</strong> (<em>int</em>) – Sample rate in Hz. The default is 30.</li>
<li><strong>order</strong> (<em>int</em>) – Sin wave can be approx represented as quadratic. The default is 2.</li>
<li><strong>nyq</strong> (<em>float</em>) – Nyquist frequency, 0.75*fs is a good value to start. The default is 0.75*30.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Filtered data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.makeaxisdivs">
<code class="descclassname">functions.</code><code class="descname">makeaxisdivs</code><span class="sig-paren">(</span><em>start</em>, <em>finish</em>, <em>divs</em>, <em>rounded=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#makeaxisdivs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.makeaxisdivs" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an axis, or vector, from ‘start’ to ‘finish’ with ‘divs’ divisions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<em>float</em>) – First value of the axis.</li>
<li><strong>finish</strong> (<em>float</em>) – Last value of the axis.</li>
<li><strong>divs</strong> (<em>int</em>) – Number of divisions</li>
<li><strong>rounded</strong> (<em>int</em>) – Number of decimals to consider. If -1 then no rounding is
performed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Axis with the set parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.makeaxisstep">
<code class="descclassname">functions.</code><code class="descname">makeaxisstep</code><span class="sig-paren">(</span><em>start=0</em>, <em>step=1.0</em>, <em>length=1000</em>, <em>adjust=False</em>, <em>rounded=-1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#makeaxisstep"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.makeaxisstep" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an axis, or vector, from ‘start’ with bins of length ‘step’ 
for a distance of ‘length’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>start</strong> (<em>float</em>) – first value of the axis. Default is 0.</li>
<li><strong>step</strong> (<em>float</em>) – Step size for the axis. Default is 1.00.</li>
<li><strong>length</strong> (<em>int</em>) – LEngth of axis. Default is 1000.</li>
<li><strong>adjust</strong> (<em>boolean</em>) – If True, rounds (adjusts) the deimals points to the same
as the step has. Default is False.</li>
<li><strong>rounded</strong> (<em>int</em>) – Number of decimals to consider. If -1 then no rounding is
performed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Axis with the set parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.mdscore">
<code class="descclassname">functions.</code><code class="descname">mdscore</code><span class="sig-paren">(</span><em>x_p</em>, <em>y_p</em>, <em>tar</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#mdscore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.mdscore" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the distance between points and the median center (MD) of
clusters and sets the prediction to the closest MD. This score may be
higher or lower than the algorithm score.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x_p</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Coordinates of x-axis.</li>
<li><strong>y_p</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Coordinates of y-axis.</li>
<li><strong>tar</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Targets of each point.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Score by comparing MD distances. Prediction using MD distances. 
X-axis coords of ths CMs. Y-axis coords of the Cms.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float, list[int],list[float],list[float]]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.median">
<code class="descclassname">functions.</code><code class="descname">median</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#median"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.median" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the median vector of a list of vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of vectors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">median curve</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.mergedata">
<code class="descclassname">functions.</code><code class="descname">mergedata</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#mergedata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.mergedata" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges data, it can merge large vectors. Useful to merge features
before performing ML algorithms.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em>) – List of arrays.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List with the merged data.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.minmax">
<code class="descclassname">functions.</code><code class="descname">minmax</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#minmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.minmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the vectors that contain the minimum and maximum values of each
bin from a list of vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>list</em>) – List of vectors to calculate the minimum and maximum vectors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">minimum and maximum vectors.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.moveavg">
<code class="descclassname">functions.</code><code class="descname">moveavg</code><span class="sig-paren">(</span><em>data</em>, <em>move=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#moveavg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.moveavg" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the moving average of a single or multiple vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to calculate the moving average. Single or multiple vectors.</li>
<li><strong>move</strong> (<em>int</em>) – Average range to each side (total average = move + 1).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Smoothed vector(s).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normsum">
<code class="descclassname">functions.</code><code class="descname">normsum</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normsum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the sum under the curve to 1, for single or multiple spectras.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single spectra or a list of them.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Normalized data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normtoglobalmax">
<code class="descclassname">functions.</code><code class="descname">normtoglobalmax</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normtoglobalmax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normtoglobalmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes a list of spectras to the global max.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of spectras.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Normalized data</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normtomax">
<code class="descclassname">functions.</code><code class="descname">normtomax</code><span class="sig-paren">(</span><em>data</em>, <em>zeromin=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normtomax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normtomax" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes spectras to the maximum value of each, in other words, the
maximum value of each spectras is set to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single or multiple vectors to normalize.</li>
<li><strong>zeromin</strong> (<em>boolean</em>) – If <cite>True</cite>, the minimum value is traslated to 0. Default
values is <cite>False</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Normalized data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normtopeak">
<code class="descclassname">functions.</code><code class="descname">normtopeak</code><span class="sig-paren">(</span><em>y</em>, <em>x</em>, <em>peak</em>, <em>shift=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normtopeak"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normtopeak" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the spectras to a particular peak.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to be normalized.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X-axis of the data</li>
<li><strong>peak</strong> (<em>int</em>) – Peak position in x-axis values.</li>
<li><strong>shift</strong> (<em>int</em>) – Range to look for the real peak. The default is 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Normalized data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normtoratio">
<code class="descclassname">functions.</code><code class="descname">normtoratio</code><span class="sig-paren">(</span><em>data</em>, <em>r1</em>, <em>r2</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normtoratio"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normtoratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes a peak to the ratio vaue respect to another. That is, the peak
found in the range of r1 is normalized to the ratio r1/(r1+r2).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single spectra or a list of them.</li>
<li><strong>r1</strong> (<em>list</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Range of the first area according to the axis.</li>
<li><strong>r2</strong> (<em>list</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em>) – Range of the second area according to the axis.</li>
<li><strong>axis</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Axis of the data. If <cite>None</cite> then it goes from 0 to N, where
N is the length of the spectras.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Normalized data</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.normtovalue">
<code class="descclassname">functions.</code><code class="descname">normtovalue</code><span class="sig-paren">(</span><em>data</em>, <em>val</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#normtovalue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.normtovalue" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes the spectras to a set value, in other words, the defined value
will be reescaled to 1 in all the spectras.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single or multiple vectors to normalize.</li>
<li><strong>val</strong> (<em>float</em>) – Value to normalize to.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Normalized data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.peakfinder">
<code class="descclassname">functions.</code><code class="descname">peakfinder</code><span class="sig-paren">(</span><em>y</em>, <em>x=None</em>, <em>between=False</em>, <em>ranges=None</em>, <em>look=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#peakfinder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.peakfinder" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds the location of the peaks in a single vector.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to find a peak in. Single spectra.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X axis of the data. If no axis is passed then the axis goes 
from 0 to N, where N is the length of the spectras. Default is <cite>None</cite>.</li>
<li><strong>between</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Range in x values</li>
<li><strong>ranges</strong> (<em>list</em><em>[</em><em>[</em><em>float</em><em>, </em><em>float</em><em>]</em><em>]</em>) – Aproximate ranges of known peaks, if any. If no ranges are 
known or defined, it will return all the peaks that comply with the 
<cite>look</cite> criteria. If ranges are defined, it wont use the <cite>look</cite> criteria,
but just for the absolute maximum within the range. Default is <cite>None</cite>.</li>
<li><strong>look</strong> (<em>int</em>) – Amount of position to each side to decide if it is a local 
maximum. The default is 10.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A list of the index of the peaks found.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[int]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.pearson">
<code class="descclassname">functions.</code><code class="descname">pearson</code><span class="sig-paren">(</span><em>data</em>, <em>labels=[]</em>, <em>cm='seismic'</em>, <em>fons=20</em>, <em>figs=(20</em>, <em>17)</em>, <em>tfs=25</em>, <em>ti='Pearson'</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#pearson"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.pearson" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Pearson matrix and plots it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to correlate.</li>
<li><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Labels of the data.</li>
<li><strong>cm</strong> (<em>str</em>) – Color map as for matplolib. The default is “seismic”.</li>
<li><strong>fons</strong> (<em>int</em>) – Plot font size. The default is 20.</li>
<li><strong>figs</strong> (<em>tuple</em>) – Plot size. The default is (20,17).</li>
<li><strong>tfs</strong> (<em>int</em>) – Title font size. The default is 25.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True plots the matrix. The default is True.</li>
<li><strong>ti</strong> (<em>str</em>) – Plot title/name. The default is “spearman”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Pearson plot in a 2d list.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.plot2dml">
<code class="descclassname">functions.</code><code class="descname">plot2dml</code><span class="sig-paren">(</span><em>train, test=[], names=['D1', 'D2', 'T'], train_pred=[], test_pred=[], labels=[], title='', xax='x', yax='y', fs=15, lfs=10, loc='best', size=20, xlim=[], ylim=[], plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#plot2dml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.plot2dml" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 2-dimensional results from LDA, PCA, NCA, or similar machine learning
algoruthms where the output has 2 features per sample.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>train</strong> (<em>pandas frame</em>) – Results for the training set. Pandas frame with the 2 dimensions
and target columns.</li>
<li><strong>test</strong> (<em>pandas frame</em>) – Results for the test set. Pandas frame with the 2 dimensions
and target columns.</li>
<li><strong>names</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Name of the lables in the dataframe. For example, for LDA:
D1, D2 and T.</li>
<li><strong>train_pred</strong> (<em>list</em>) – Prediction of the training set.</li>
<li><strong>test_pred</strong> (<em>list</em>) – Prediction of the test set.</li>
<li><strong>labels</strong> (<em>list</em>) – Names for the classification groups, if any.</li>
<li><strong>title</strong> (<em>str</em>) – Title of the plot.</li>
<li><strong>xax</strong> (<em>str</em>) – Name ox x-axis</li>
<li><strong>yax</strong> (<em>str</em>) – Name of y-axis</li>
<li><strong>lfs</strong> (<em>int</em>) – Legend font size. Default is 15.</li>
<li><strong>loc</strong> (<em>str</em>) – Location of legend. Default is best.</li>
<li><strong>size</strong> (<em>int</em>) – Size of the markers. Default is 20.</li>
<li><strong>xlim</strong> (<em>list</em>) – Limits of the x axis.</li>
<li><strong>ylim</strong> (<em>list</em>) – Limits of the y axis.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True it plot. Only for test purposes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Plot</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.polybaseline">
<code class="descclassname">functions.</code><code class="descname">polybaseline</code><span class="sig-paren">(</span><em>data</em>, <em>axis</em>, <em>points</em>, <em>deg=2</em>, <em>avg=5</em>, <em>remove=True</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#polybaseline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.polybaseline" title="Permalink to this definition">¶</a></dt>
<dd><p>Calcuates the baseline using polynomial fit.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Single or several spectras to remove the baseline from.</li>
<li><strong>axis</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – x axis of the data, to interpolate the baseline function.</li>
<li><strong>points</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – positions in axis of points to calculate baseline.</li>
<li><strong>deg</strong> (<em>int</em>) – Polynomial degree of the fit.</li>
<li><strong>avg</strong> (<em>int</em>) – points to each side to make average.</li>
<li><strong>remove</strong> (<em>True</em>) – if True, calculates and returns (data - baseline).</li>
<li><strong>plot</strong> (<em>bool</em>) – if True, calculates and returns (data - baseline).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The baseline.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.regression">
<code class="descclassname">functions.</code><code class="descname">regression</code><span class="sig-paren">(</span><em>target</em>, <em>variable</em>, <em>cov=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#regression"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.regression" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs an N dimensional regression.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>target</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Y-axis values, values to predict.</li>
<li><strong>variable</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X-axis values.</li>
<li><strong>cov</strong> (<em>int</em>) – If 1 is regression with covariance, like spearman. The default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Prediction of the fitting and the Fitting parameters.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[list[float],list[float]]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.rwm">
<code class="descclassname">functions.</code><code class="descname">rwm</code><span class="sig-paren">(</span><em>y</em>, <em>ws</em>, <em>plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#rwm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.rwm" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the median of an array in a running window defined by the user.
The window size needs to be a 2D tuple or list, with the first element being the
length of the spectra and the second the total width that will be taken into account
for the statistics.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>numpy array</em>) – The spectras</li>
<li><strong>ws</strong> (<em>tuple/list</em>) – Window size parameters</li>
<li><strong>plot</strong> (<em>boolean</em>) – If you want to plot the new spectra change to True</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array containing the computed 1D spectra.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy array[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.sdev">
<code class="descclassname">functions.</code><code class="descname">sdev</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#sdev"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.sdev" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the standard deviation for each bin from a list of vectors.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of vectors.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Standard deviation curve</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.shiftref">
<code class="descclassname">functions.</code><code class="descname">shiftref</code><span class="sig-paren">(</span><em>ref_data</em>, <em>ref_axis</em>, <em>ref_peak=520</em>, <em>mode=1</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#shiftref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.shiftref" title="Permalink to this definition">¶</a></dt>
<dd><p>Shifts the x-axis according to a shift calculated prior.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ref_data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Reference measurement.</li>
<li><strong>ref_axis</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – X-axis of the reference measurement.</li>
<li><strong>ref_peak</strong> (<em>float</em>) – Where the reference peak should be in x-axis values. The default is 520 (Raman Si).</li>
<li><strong>mode</strong> (<em>int</em>) – Fitting method, Lorentz, Gaussian, or none (1,2,3). The default is 1.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True plots a visual aid. The default is True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Shift amount</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.shuffle">
<code class="descclassname">functions.</code><code class="descname">shuffle</code><span class="sig-paren">(</span><em>arrays</em>, <em>delratio=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#shuffle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><p>Merges and shuffles data and then separates it so it is shuffles together.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>arrays</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em>) – List of arrays of data.</li>
<li><strong>delratio</strong> (<em>float</em>) – Ratio of the data to be deleted, 0 &lt; delratio &lt; 1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">List of the shuffled arrays.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[list[float]]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.spearman">
<code class="descclassname">functions.</code><code class="descname">spearman</code><span class="sig-paren">(</span><em>data</em>, <em>labels=[]</em>, <em>cm='seismic'</em>, <em>fons=20</em>, <em>figs=(20</em>, <em>17)</em>, <em>tfs=25</em>, <em>ti='Spearman'</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#spearman"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.spearman" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Pearson matrix and plots it.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to correlate.</li>
<li><strong>labels</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – Labels of the data.</li>
<li><strong>cm</strong> (<em>str</em>) – Color map as for matplolib. The default is “seismic”.</li>
<li><strong>fons</strong> (<em>int</em>) – Plot font size. The default is 20.</li>
<li><strong>figs</strong> (<em>tuple</em>) – Plot size. The default is (20,17).</li>
<li><strong>tfs</strong> (<em>int</em>) – Title font size. The default is 25.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True plots the matrix. The default is True.</li>
<li><strong>ti</strong> (<em>str</em>) – Plot title/name. The default is “spearman”.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Spearman plot in a 2d list.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.stackplot">
<code class="descclassname">functions.</code><code class="descname">stackplot</code><span class="sig-paren">(</span><em>y</em>, <em>offset</em>, <em>order=None</em>, <em>xlabel=''</em>, <em>ylabel=''</em>, <em>title=''</em>, <em>cmap='Spectral'</em>, <em>figsize=(6</em>, <em>9)</em>, <em>fs=20</em>, <em>lw=1</em>, <em>xlim=None</em>, <em>plot=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#stackplot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.stackplot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a stack plot of selected spectras.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to plot. Must be more than 1 vector.</li>
<li><strong>offset</strong> (<em>float</em>) – displacement, or difference, between each curve.</li>
<li><strong>order</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Order of the curves in which they are plotted. If <cite>None</cite>,
is the order as they appear in the list.</li>
<li><strong>xlabel</strong> (<em>str</em>) – Label of axis.</li>
<li><strong>ylabel</strong> (<em>str</em>) – Label of axis.</li>
<li><strong>title</strong> (<em>str</em>) – Title of the plot.</li>
<li><strong>cmap</strong> (<em>str</em>) – Colormap, according to matplotlib options.</li>
<li><strong>figsize</strong> (<em>tuple</em>) – Size of the plot. Default is (3, 4.5)</li>
<li><strong>fs</strong> (<em>float</em>) – Font size. Default is 20.</li>
<li><strong>lw</strong> (<em>float</em>) – Linewidth of the curves.</li>
<li><strong>xlim</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Plot limits for x-axis. If <cite>None</cite> it plots all.</li>
<li><strong>plot</strong> (<em>bool</em>) – If True it plot. Only for test purposes.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">plot</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.studentfit">
<code class="descclassname">functions.</code><code class="descname">studentfit</code><span class="sig-paren">(</span><em>y=[0], x=[0], pos=0, look=5, shift=5, v=0.01, manual=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#studentfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.studentfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits peak as an optimization problem.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>y</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Data to fit. Single vector.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – x axis.</li>
<li><strong>pos</strong> (<em>int</em>) – Peak index to fit to.</li>
<li><strong>look</strong> (<em>int</em>) – index positions to look to each side. The default is 20.</li>
<li><strong>shift</strong> (<em>int</em>) – Possible index shift of the peak. The default is 5.</li>
<li><strong>v</strong> (<em>float</em>) – . The default is 0.01.</li>
<li><strong>manual</strong> (<em>boolean</em>) – If <cite>True</cite>, 1 curve will be generated using the declared 
parameter <cite>sigma</cite> and perform a manual fit. Default is <cite>False</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Fitted curve.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.subtractref">
<code class="descclassname">functions.</code><code class="descname">subtractref</code><span class="sig-paren">(</span><em>data, ref, axis=0, alpha=0.9, sample=0, lims=[0, 0], plot=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#subtractref"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.subtractref" title="Permalink to this definition">¶</a></dt>
<dd><p>Subtracts a reference spectra from the measurements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of or single vector.</li>
<li><strong>ref</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – reference data to remove.</li>
<li><strong>axis</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Axis for both ´data´ and ‘ref’, only for plotting purposes.</li>
<li><strong>alpha</strong> (<em>float</em>) – Manual multiplier. The default is 0.9.</li>
<li><strong>sample</strong> (<em>int</em>) – Sample spectra to work with. The default is 0.</li>
<li><strong>lims</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Limits of the plot.</li>
<li><strong>plot</strong> (<em>bool</em>) – To plot or not a visual aid. The default is True.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Data with the subtracted reference.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[float]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.trim">
<code class="descclassname">functions.</code><code class="descname">trim</code><span class="sig-paren">(</span><em>data</em>, <em>start=0</em>, <em>finish=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#trim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.trim" title="Permalink to this definition">¶</a></dt>
<dd><p>Deletes columns in a list from start to finish.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>list</em>) – Data to be trimmed. Single vector at the moment.</li>
<li><strong>start</strong> (<em>int</em><em>, </em><em>optional</em>) – Poistion of the starting point. The default is 0.</li>
<li><strong>finish</strong> (<em>int</em><em>, </em><em>optional</em>) – Position of the ending point (not included). The default is 0.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Trimmed data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.typical">
<code class="descclassname">functions.</code><code class="descname">typical</code><span class="sig-paren">(</span><em>y</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#typical"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.typical" title="Permalink to this definition">¶</a></dt>
<dd><p>Looks for the typical spectra of a dataset. In other words, it calculates 
the average spectra and looks for the one that is closer to it in relation
to standard deviation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>y</strong> (<em>list</em><em>[</em><em>list</em><em>[</em><em>float</em><em>]</em><em>]</em>) – A list of spectras.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The typical spectra of the set.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list[float]</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="functions.valtoind">
<code class="descclassname">functions.</code><code class="descname">valtoind</code><span class="sig-paren">(</span><em>vals</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/functions.html#valtoind"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#functions.valtoind" title="Permalink to this definition">¶</a></dt>
<dd><p>To translate the value in an axis to its index in the axis, basically
searches for the position of the value. It approximates to the closest.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vals</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – List of values to be searched and translated.</li>
<li><strong>x</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Axis.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Index, or position, in the axis of the values in vals</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list[int], int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="quickstart.html" class="btn btn-neutral float-left" title="Quickstart" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Institut de Recerca en Energia de Catalunya.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>